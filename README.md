# WordPress-MySQL-Kubernetes

apiVersion: apps/v1
# Объявить объект ресурса развертывания
kind: Deployment
metadata:
  name: deployment-myapp
spec:
 # Объявляем количество контейнеров 2 через реплики  
  replicas: 2
 # Выберите управляемый модуль по тегу    
  selector:
    matchLabels:
      app: myapp
 # Определить под в шаблоне      
  template:
    metadata:
 # Отметить pod app = myapp    
      labels:
        app: myapp
    spec:
      containers:
 # Объявить имя контейнера, обратите внимание, что это не имя модуля, имя модуля должно быть определено в метаданных
      - name: myapp
        image: ikubernetes/myapp:v1
        ports:
        - name: http
          containerPort: 80
 # Разделить несколько объектов ресурсов в файле yaml через ---          
---
apiVersion: v1
 # Объявить объект ресурса службы
kind: Service
metadata:
  name: service-myapp
spec:
 # service-myapp выберет модуль, тег которого содержит app = myapp
  selector:
    app: myapp
  ports:
  - name: http
 # Порт прослушивания службы  
    port: 80
 # Перенаправить на номер порта серверного модуля   
    targetPort: 80
  
  
Pod：

Pod - это комбинация одного или нескольких контейнеров, которые совместно используют хранилище, сеть и пространство имен, а также спецификации того, как работать. Pod - это самая маленькая развертываемая единица Kubernetes. Китайский перевод Pod - гороховый стручок, а докер-контейнер похож на бобы, запущенные в стручке гороха.

ReplicaSet：
Сначала позвольте мне поговорить о контроллере репликации. Роль контроллера репликации состоит в том, чтобы гарантировать, что Pod работает с указанным количеством реплик.
ReplicaSet - это обновленная версия Replication Controller. Единственное различие между ReplicaSet и Replication Controller - это поддержка селекторов. Контроллер репликации поддерживает только селекторы на основе уравнений (env = dev или environment! = Qa), но ReplicaSet также поддерживает новые селекторы на основе наборов (версия в (v1.0, v2.0) или env notin (dev, qa) )).
В файле yaml объявите количество реплик модуля через spec.replicas.

Deployment：
Развертывание используется для управления Pod и ReplicaSet, которые могут реализовать последовательное обновление и откат приложения, расширение и сжатие.

Service：
Представьте себе проблему. ReplicaSet определяет количество модулей равным 2. Когда модуль по какой-либо причине останавливается, ReplicaSet создает новый модуль, чтобы гарантировать, что количество работающих модулей всегда равно 2. Но у каждого модуля есть свой IP-адрес, и внешний запрос не знает, какой IP у этого нового модуля. Как можно отправить внешний запрос новому модулю?
Ответ - использовать Сервис
Служба k8s определяет адрес входа доступа к службе. Внешнее приложение использует этот адрес входа для доступа к группе экземпляров кластера, состоящей из копий Pod, находящихся за ним, и загружаются запросы доступа извне. Баланс между различными контейнерными приложениями на задней панели. Служба и ее серверный кластер реплик Pod связаны с помощью Label Selector.
Пожалуйста, говорите по-человечески: внешний запрос отправляется не напрямую в модуль, а в службу, и служба пересылает запрос в модуль.

Подводя итог: Pod управляется ReplicaSet, а ReplicaSet контролирует количество модулей; ReplicaSet управляется Deployment, а Deployment контролирует обновление и откат приложений Pod. Конечно, он также может контролировать количество модулей. Сервис предоставляет единый фиксированный вход, который отвечает за пересылку внешних запросов в Pod.
